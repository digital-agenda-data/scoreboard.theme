<html metal:use-macro="here/main_template/macros/master"
  i18n:domain="plone">
  <div metal:fill-slot="main" tal:define="cube nocall:here;
                                          normalizeString nocall:context/plone_utils/normalizeString;
                                          isAnon context/@@plone_portal_state/anonymous;">
    <div id="homepage-listing" class="scoreboard-listing">
      <h1>Digital Agenda Scoreboard</h1>
      <div style="clear:both"></div>
      <div class="listing-description">
        The Scoreboard assesses progress with respect to the targets set out in the Digital Agenda. In addition, it provides analysis and detailed data on all the policy areas covered by the Digital Agenda.
      </div>
      <h2>Please select one of the available datasets:</h2>


      <tal:block define="cubes view/getDataCubes">
        <p tal:condition="not:cubes">
          No Data Cubes.
        </p>
        <table class="scoreboard-datacubes-listing">
          <tal:row repeat="cube cubes">
          <tr class="scoreboard-datacubes-listing-item" tal:attributes="
            id cube/getId;
            data-name cube/getId;
            data-parent python:cube.getParentNode().absolute_url()">
            <td tal:define="has_thumbnail python:'thumbnail' in cube.objectIds()">
              <a tal:attributes="href string:${cube/absolute_url}/visualizations">
                <img tal:condition="has_thumbnail" tal:attributes="src string:${cube/absolute_url}/thumbnail/image_preview"/>
                <img tal:condition="not:has_thumbnail" src="++resource++scoreboard.theme.images/connect_thumbnail.png" />
              </a>
            </td>
            <td>
              <a tal:attributes="href string:${cube/absolute_url}/visualizations">
                <h5><span tal:replace="repeat/cube/number"/>. <span tal:replace="python:cube.getExtended_title() or cube.title_or_id()"/></h5>
              </a>
              <p tal:content="structure cube/getSummary"></p>
              <ul class="linklist">
                <li tal:define="state python:view.getItemState(cube)" tal:condition="not:isAnon">
                  <span>Status:</span>
                  <span tal:content="state" tal:attributes="class python:'state-%s' % normalizeString(state)">STATE</span>
                </li>
                <li><a tal:attributes="href string:${cube/absolute_url}/indicators">
                  Consult the list of indicators, their definition and sources</a></li>
                <li><a tal:attributes="href string:${cube/absolute_url}">
                  Download the original datasets</a></li>
              </ul>
            </td>
          </tr>
          </tal:row>
        </table>
      </tal:block>
    </div>
  </div>
</html>

