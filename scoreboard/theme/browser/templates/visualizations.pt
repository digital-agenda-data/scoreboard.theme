<html metal:use-macro="here/main_template/macros/master"
  i18n:domain="plone">
  <div metal:fill-slot="main"
    tal:define="cube nocall:here;
                isAnon context/@@plone_portal_state/anonymous;
                canModify python:checkPermission('Modify portal content', cube);">
    <div id="scoreboard-visualizations-listing" class="scoreboard-listing bootstrap">
      <h1 tal:content="cube/getExtended_title"></h1>
      <div style="clear:both"></div>
      <div class="listing-description">
        <tal:block tal:replace="structure cube/getSummary"></tal:block>
      </div>
      <h2>Please select one of the available graphs:</h2>

      <tal:block define="visualizations view/visualizations">
        <p tal:condition="not:visualizations">
          No visualizations.
        </p>
        <div tal:condition="canModify" class="pull-right">
          <a class="btn btn-mini btn-primary" tal:attributes="href string:${here/absolute_url}/addVisualization">
            <i class="icon-plus-sign icon-white"></i> Add Scoreboard visualization</a>
        </div>
        <div style="clear: both;"></div>
        <br />
        <table class="scoreboard-visualizations-listing">
          <tal:row repeat="vis visualizations">
          <tr class="scoreboard-visualizations-listing-item" tal:attributes="
            id vis/UID;
            data-name vis/UID;
            data-parent python:cube.absolute_url();">
            <td tal:define="has_thumbnail python:hasattr(vis, 'thumbnail')">
              <a tal:attributes="href vis/absolute_url">
                <img tal:condition="has_thumbnail" tal:define="scale vis/@@images"
                     tal:replace="structure python: scale.scale('thumbnail', width=221, height=171, direction='down').tag()" />
                <img tal:condition="not:has_thumbnail" src="++resource++scoreboard.theme.images/map_thumbnail.png" />
              </a>
            </td>
            <td>
              <a tal:attributes="href vis/absolute_url">
                <h5><span tal:replace="repeat/vis/number"/>. <span tal:replace="vis/Title"/></h5>
              </a>
              <p tal:content="vis/Description"></p>
              <div class="dataset-manage" tal:condition="canModify">
                <a class="btn btn-mini btn-warning" tal:attributes="href string:${vis/absolute_url}/edit"><i class="icon-edit icon-white"></i> Edit</a>
                <a class="btn btn-mini btn-danger" tal:attributes="href string:${vis/absolute_url}/delete_confirmation"><i class="icon-trash icon-white"></i> Delete</a>
                <a class="btn btn-mini btn-primary" tal:attributes="href string:${vis/absolute_url}/daviz-edit.html"><i class="icon-tasks icon-white"></i> Configure</a>
              </div>
            </td>
          </tr>
          </tal:row>
        </table>
      </tal:block>
      <h2>Further Information</h2>
      <ul>
        <li><a tal:attributes="href string:${cube/absolute_url}/indicators">Consult the list of selected indicators, their definition and sources</a>
        <li><a tal:attributes="href cube/absolute_url">Download the original datasets</a>
      </ul>
      <p class="listing-footer">
        <a href="http://lod2.eu/"><img src="++resource++scoreboard.theme.images/logo-lod2.png" class="footer-logo" /></a>
        This visualisation tool was made with the help of the <a href="http://lod2.eu/">Linked Open data, "LOD2" project</a>, co-funded by the
        European Commission within the FP7 Information and Communication Technologies Work Programme (Grant Agreement No.&nbsp;257943).
        <br>The project aims at building an integrated technology stack for publishing linked data. The visualisation and open data pages for the
        digital agenda scoreboard  have been executed as part of the publink activities of the LOD2 project by the LOD2 partners:
        Tenforce, AKSW research group at the University of Leipzig and OpenLink Software
      </p>
      <div style="clear:both" />
    </div>
  </div>
</html>

